(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const c of e.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerPolicy&&(e.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?e.credentials="include":r.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(r){if(r.ep)return;r.ep=!0;const e=s(r);fetch(r.href,e)}})();const f=10,l=20;let a=Array.from({length:l},()=>Array(f).fill(0));const g=[{shape:[[1,1],[1,1]],x:0,y:0,color:"yellow"},{shape:[[1,1,1,1]],x:0,y:0,color:"Cyan"},{shape:[[1,1,0],[0,1,1]],x:0,y:0,color:"red"},{shape:[[0,1,1],[1,1,0]],x:0,y:0,color:"green"},{shape:[[1,1,1],[0,1,0]],x:0,y:0,color:"purple"},{shape:[[1,0,0],[1,1,1]],x:0,y:0,color:"orange"},{shape:[[0,0,1],[1,1,1]],x:0,y:0,color:"blue"}],w=()=>{var t,n;const s=Math.floor(Math.random()*g.length),o={...g[s]};if(!o.shape||o.shape.length===0)throw new Error("テトロミノのshapeが不正です");const r=(n=(t=o.shape[0])===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:1;return o.x=Math.floor((f-r)/2),o};let i=w();function y(){const t=document.getElementById("tetris_container");t.innerHTML="",A();for(let n=0;n<l;n++)for(let s=0;s<f;s++){const o=document.createElement("div");o.className="cell";const r=i.shape.some((e,c)=>e.some((u,h)=>u===1&&i.x+h===s&&i.y+c===n));if(a[n][s]===1||r){o.classList.add("filled");const e=i.color;o.style.backgroundColor=e}t.appendChild(o)}}function A(){i.shape.forEach((t,n)=>{t.forEach((s,o)=>{if(s===1){const r=i.x+o,e=i.y+n;r>=0&&r<f&&e>=0&&e<l&&a[e]!==void 0&&a[e][r]!==void 0&&a[e][r]===2&&(a[e][r]=0)}})})}function v(){i.shape.forEach((t,n)=>{t.forEach((s,o)=>{if(s===1){const r=i.x+o,e=i.y+n;(r>=0||r<f||e>=0||e<l)&&a[e]!==void 0&&a[e][r]!==void 0&&(a[e][r]=2)}})})}function I(){i.shape.forEach((n,s)=>{n.forEach((o,r)=>{if(o===1){const e=i.x+r,c=i.y+s;e>=0&&e<f&&c>=0&&c<l&&a[c]!==void 0&&a[c][e]!==void 0&&(a[c][e]=1,a[c][e]===2&&(a[c][e]=0))}})}),O(),i.y===0&&(clearInterval(p),alert("GAME OVER")),i=w()}let x=0;function O(){a=a.filter(n=>n.some(s=>s===0));const t=l-a.length;for(x+=t*100,document.getElementById("score").innerText=`${x}`;a.length<l;)a.unshift(Array(f).fill(0))}function E(){b(0,1)?i.y+=1:I(),v(),y()}let T=1e3,p=setInterval(E,T);function b(t,n){return i.shape.every((s,o)=>s.every((r,e)=>{var c;if(r===0)return!0;const u=i.x+e+t,h=i.y+o+n;return!(u<0||u>=f||h>=l||((c=a[h])===null||c===void 0?void 0:c[u])===1)}))}function _(t){return t.every((n,s)=>n.every((o,r)=>{var e;if(o===0)return!0;const c=i.x+r,u=i.y+s;return!(c<0||c>=f||u>=l||((e=a[u])===null||e===void 0?void 0:e[c])===1)}))}function L(){for(let t=0;t<l;t++)for(let n=0;n<f;n++)a[t][n]===2&&(a[t][n]=0);v()}function m(t,n){b(t,n)&&(i.x+=t,i.y+=n),L(),y()}function M(){const t=P(i.shape);_(t)&&(i.shape=t,L(),y())}function P(t){return t.length===0?[]:t[0].map((n,s)=>t.map(o=>{var r;return(r=o[s])!==null&&r!==void 0?r:0}).reverse())}let d=!1;function C(){d?(p=setInterval(E,T),d=!1):(clearInterval(p),d=!0)}document.addEventListener("keydown",N);function N(t){switch(t.key){case"ArrowLeft":d||m(-1,0);break;case"ArrowRight":d||m(1,0);break;case"ArrowDown":d||m(0,1);break;case"ArrowUp":d||M();break;case" ":C();break}}v();y();
