(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(e){if(e.ep)return;e.ep=!0;const r=s(e);fetch(e.href,r)}})();const f=10,l=20;let a=Array.from({length:l},()=>Array(f).fill(0));const g=[{shape:[[1,1],[1,1]],x:0,y:0,color:"yellow"},{shape:[[1,1,1,1]],x:0,y:0,color:"Cyan"},{shape:[[1,1,0],[0,1,1]],x:0,y:0,color:"red"},{shape:[[0,1,1],[1,1,0]],x:0,y:0,color:"green"},{shape:[[1,1,1],[0,1,0]],x:0,y:0,color:"purple"},{shape:[[1,0,0],[1,1,1]],x:0,y:0,color:"orange"},{shape:[[0,0,1],[1,1,1]],x:0,y:0,color:"blue"}],w=()=>{var t,n;const s=Math.floor(Math.random()*g.length),o={...g[s]};if(!o.shape||o.shape.length===0)throw new Error("テトロミノのshapeが不正です");const e=(n=(t=o.shape[0])===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:1;return o.x=Math.floor((f-e)/2),o};let i=w();function y(){const t=document.getElementById("tetris_container");t.innerHTML="",I();for(let n=0;n<l;n++)for(let s=0;s<f;s++){const o=document.createElement("div");o.className="cell";const e=i.shape.some((c,u)=>c.some((h,A)=>h===1&&i.x+A===s&&i.y+u===n)),r=i.color;(a[n][s]===1||e)&&(o.classList.add("filled"),o.style.backgroundColor=r),t.appendChild(o)}}function I(){i.shape.forEach((t,n)=>{t.forEach((s,o)=>{if(s===1){const e=i.x+o,r=i.y+n;e>=0&&e<f&&r>=0&&r<l&&a[r]!==void 0&&a[r][e]!==void 0&&a[r][e]===2&&(a[r][e]=0)}})})}function v(){i.shape.forEach((t,n)=>{t.forEach((s,o)=>{if(s===1){const e=i.x+o,r=i.y+n;(e>=0||e<f||r>=0||r<l)&&a[r]!==void 0&&a[r][e]!==void 0&&(a[r][e]=2)}})})}function O(){i.shape.forEach((n,s)=>{n.forEach((o,e)=>{if(o===1){const r=i.x+e,c=i.y+s;r>=0&&r<f&&c>=0&&c<l&&a[c]!==void 0&&a[c][r]!==void 0&&(a[c][r]=1,a[c][r]===2&&(a[c][r]=0))}})}),_(),i.y===0&&(clearInterval(p),alert("GAME OVER")),i=w()}let x=0;function _(){a=a.filter(n=>n.some(s=>s===0));const t=l-a.length;for(x+=t*100,document.getElementById("score").innerText=`${x}`;a.length<l;)a.unshift(Array(f).fill(0))}function E(){b(0,1)?i.y+=1:O(),v(),y()}let T=1e3,p=setInterval(E,T);function b(t,n){return i.shape.every((s,o)=>s.every((e,r)=>{var c;if(e===0)return!0;const u=i.x+r+t,h=i.y+o+n;return!(u<0||u>=f||h>=l||((c=a[h])===null||c===void 0?void 0:c[u])===1)}))}function M(t){return t.every((n,s)=>n.every((o,e)=>{var r;if(o===0)return!0;const c=i.x+e,u=i.y+s;return!(c<0||c>=f||u>=l||((r=a[u])===null||r===void 0?void 0:r[c])===1)}))}function L(){for(let t=0;t<l;t++)for(let n=0;n<f;n++)a[t][n]===2&&(a[t][n]=0);v()}function m(t,n){b(t,n)&&(i.x+=t,i.y+=n),L(),y()}function P(){const t=C(i.shape);M(t)&&(i.shape=t,L(),y())}function C(t){return t.length===0?[]:t[0].map((n,s)=>t.map(o=>{var e;return(e=o[s])!==null&&e!==void 0?e:0}).reverse())}let d=!1;function N(){d?(p=setInterval(E,T),d=!1):(clearInterval(p),d=!0)}document.addEventListener("keydown",R);function R(t){switch(t.key){case"ArrowLeft":d||m(-1,0);break;case"ArrowRight":d||m(1,0);break;case"ArrowDown":d||m(0,1);break;case"ArrowUp":d||P();break;case" ":N();break}}v();y();
